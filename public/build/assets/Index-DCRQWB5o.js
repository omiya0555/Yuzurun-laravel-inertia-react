import{r as n,j as t,M as g,h as j}from"./app-DPh2l7GI.js";import{c as y,q as w,o as N,w as u,a as R,d as C}from"./firebaseConfig-COc0cFUU.js";import{A as _}from"./AuthenticatedLayout-DwVj9hKc.js";import"./ResponsiveNavLink-QH_vOUXO.js";import"./transition-BaM-Rkh4.js";function S({user_id:s}){const[i,b]=n.useState([]),[d,l]=n.useState([]),[r,f]=n.useState("all"),o=document.createElement("div");o.className="loading-overlay",document.body.appendChild(o),n.useEffect(()=>{o.classList.add("active");const e=y(C,"chat_rooms"),a=w(e,N(u("buyer_id","==",s),u("seller_id","==",s))),v=R(a,x=>{const m=x.docs.map(h=>({id:h.id,...h.data()}));b(m),l(m),o.classList.remove("active")},x=>{console.log("チャットルーム取得エラー"),o.classList.remove("active")});return()=>v()},[s]);const c=e=>{f(e),e==="all"?l(i):e==="give"?l(i.filter(a=>a.seller_id===s)):e==="receive"&&l(i.filter(a=>a.buyer_id===s))},p=e=>{j.get(`/chat/room/${e}`)};return t.jsxs(_,{header:t.jsx("h2",{className:"text-xl font-semibold leading-tight text-stone-800",children:"チャット一覧"}),children:[t.jsx(g,{title:"チャット一覧"}),t.jsxs("div",{className:"flex justify-around max-w-6xl mx-auto bg-stone-200 rounded-full mb-4",children:[t.jsx("button",{className:`rounded-l-full flex-1 text-center py-2 font-semibold transition ${r==="all"?"bg-white text-stone-800 shadow":"text-stone-500 hover:bg-stone-300"}`,onClick:()=>c("all"),children:"すべて"}),t.jsx("button",{className:`flex-1 text-center py-2 font-semibold transition ${r==="give"?"bg-red-400 text-stone-800 shadow":"text-stone-500 hover:bg-red-100"}`,onClick:()=>c("give"),children:"ゆずる"}),t.jsx("button",{className:`rounded-r-full flex-1 text-center py-2 font-semibold transition ${r==="receive"?"bg-blue-400 text-stone-800 shadow":"text-stone-500 hover:bg-blue-100"}`,onClick:()=>c("receive"),children:"もらう"})]}),t.jsx("div",{className:"max-w-6xl mx-auto bg-white shadow rounded-md",children:t.jsx("ul",{children:d.length===0?t.jsx("li",{className:"py-8 text-center text-stone-600",children:"チャットルームはありません。"}):d.map(e=>t.jsxs("div",{className:"flex border-b cursor-pointer rounded-sm hover:bg-stone-300 hover:shadow-xl transition",onClick:()=>p(e.id),children:[t.jsx("img",{src:e.product_top_image_url,className:"aspect-square object-cover w-20 h-20"}),t.jsxs("li",{className:"w-full py-2 px-8",children:[t.jsx("h2",{className:"text-base md:font-semibold",children:e.product_title}),t.jsx("span",{className:"text-sm md:text-base text-gray-600",children:s===e.seller_id?`申請者：${e.buyer_name}`:`出品者：${e.seller_name}`})]},e.id)]},e.id))})})]})}export{S as default};
